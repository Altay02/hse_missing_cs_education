# gdb

В этой задаче вам предстоит поработать с [GDB](https://www.gnu.org/software/gdb/) (GNU debugger)
и поковырять бинарники (как собранные с дебажными символами, так и без оных), чтобы
извлечь из них некоторую информацию.

Проверка осуществляется с помощью [Яндекс.Контеста](https://contest.yandex.ru/contest/19426/):
вы должны отправить gdb скрипт, который будет запускаться поверх бинарей и
выдавать ответ на последней строке. Скрипт будет тестироваться таким образом:

```console
$ gdb -q $PROBLEM_NAME --batch -x $YOUR_SCRIPT_FILE 2>/dev/null | tail -n 1 | cut -f 3 -d ' '
```

Поэтому последней командой всегда должен быть `print` или `p` какого-то числа.
Если вы будете хитрить и выдавать числа, которые вы списали или получили без
честного дебага (например, просто вывели `p $ANS`),
это будет вести к обнулению баллов всего контеста -- проверка такого
жульничества будет ручной. Скрипты должны быть беспристрастны к изначальным
данным.

Каждый пункт оценивается в 2.5 балла. Округления нет -- только в конце семестра
по всем домашним заданиям.

### Задачи

1. `with_symbols`: Вам дана программа, собранная без оптимизации и с дебажными
символами. __Ответ__: значение переменной `x` после 10000-ой итерации цикла в функции `f()`.
1. `without_symbols`: На этот раз программа собрана с оптимизацией и без дебажной информации.
Придётся немного освежить знание языка ассемблера. __Ответ__: значение регистра `rax` после 10000-ой
итерации цикла (прямо перед `jne`) в функции `f()`.
1. `with_core`: Вам предстоит покопаться в кишках стандартного контейнера, используя оставшийся после
выполнения программы сore dump. К сожалению, сам контейнер частично побился из-за того же бага, что
уронил программу, но гарантируется, что данные извлечь можно. __Ответ__: `hashmap[8888][1]`.
1. `flaky`: Эта программа пытается посчитать ответ для вас, но с очень большой вероятностью падает
на полпути. __Ответ__: то, что напечатает программа, если добежит до конца.

### Используем docker

Все бинарники были собраны на ubuntu 18.04. Если у вас стоит
достаточно свежий дистрибутив linux, то задачи можно решать на нём.

Для тех, у кого OSX, Windows или какой-то странный linux, мы собрали
докер образ с правильным окружением.

```
$ docker run --privileged -it darthslon/shad-cpp:gdb /bin/bash
root@a9bc09439be8:/# cd opt
root@a9bc09439be8:/opt# ls
coredump  flaky  with_core  with_symbols  without_symbols
```

### Полезные ссылки
* https://github.com/gcc-mirror/gcc/blob/master/libstdc%2B%2B-v3/include/bits/hashtable.h
* https://www.gnu.org/software/gdb/
* https://en.wikibooks.org/wiki/X86_Assembly/GAS_Syntax
